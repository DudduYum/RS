<html>
	<head>
		<title>Project: Reach the Sun</title>

		<!--  Styles-->
		<link rel="stylesheet" type="text/css" href="style/baseStyle.css">
		<link rel="stylesheet" type="text/css" href="style/initialScreen.css">
		<link rel="stylesheet" type="text/css" href="style/gameoverScreen.css">
		<link rel="stylesheet" type="text/css" href="style/switch.css">

		<!--  Libraris-->
		<script type="text/javascript" src="lib/three.min.js"></script>
		<script type="text/javascript" src="lib/requirejs_2.2.js"></script>

		<!--  Our scripts and class-->
		<script type="text/javascript" src="js/IO_Manager.js"></script><!-- X -->
		<script type="text/javascript" src="js/game_score_counter.js"></script><!-- V -->
		<script type="text/javascript" src="js/game_state_controller.js"></script><!-- V -->
		<script type="text/javascript" src="js/game_settings_object.js"></script><!-- V -->
		<script type="text/javascript" src="js/environment_builder.js"></script><!-- V -->
		<script type="text/javascript" src="js/asteroid_class.js"></script>
		<script type="text/javascript" src="js/space_ship_class.js"></script>
		<script type="text/javascript" src="js/clock.js"></script>
		<script type="text/javascript" src="js/timer.js"></script>
		<script type="text/ogsl" id="vertex">
			varying vec3 tNorm;
			varying vec2 vUv;


			void main(){
				tNorm = normalMatrix * normal;
				gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.);
				vUv = uv;
			}
		</script>

		<script type="text/ogsl" id="fragment">
			vatying vec3 tNorm;
			varying vec2 vUv;
			uniform sampler2D texture;

			void main(){
				vec4 color = texture2D(texture,vUv);
				gl_FragColor = vec4(color.rgb, 1. );
			}
		</script>

	</head>

  	<body>
		<div id="canvas"></div>

		<div id="scoreTable">
			<h1 id="currentScore">0</h1>
		</div>

		<div id="initialScreen">
			<div id="gameTitle">
				<h1>OH LOOK, AN ASTEROID...</h1><br/>
				<h3>Damn, asteroid storm incoming!</h3><br/>
			</div>
			<div id="instructions">
				<p>- use arrows or W,A,S,D to move your spaceship and avoid asteroids</p><br/>
				<p>- click the button or press C to switch camera</p><br/>
				<p>- press [SPACEBAR] to start the game</p><br/>
				<p>Good luck!</p>
			</div>
		</div>


		<div id="gameoverScreen">
			<div id="score">
				<h1 id="yourScore"></h1><br/>
				<h3>Not bad!</h3><br/>
			</div>
			<div id="goInstructions">
				<p>Press [SPACEBAR] to play again!</p><br/>
			</div>

		</div>

		<div id="cameraSwitch">
			<div id="switchContainer">
				<button id="freeCameraButton" onclick="switchToFreeCamera()" type="button">Switch to FREE camera</button>
				<button id="gameCameraButton" onclick="switchToGameCamera()" type="button">Switch to GAME camera</button>
			</div>
		</div>

		<div id="authors">
			<p >Developed by Riccardo Lulli, Rostyslav Kostyuk</p>
		</div>

		<!--  game evocation -->
		<script type="text/javascript" >

		var a = 1;

// global scope
function one() {
  alert(a);
};
function two(a) {
  alert(a);
};

// local scope again
function three() {
  var a = 3;
  alert(a);
};

function four() {
  if (false) {
    var a = 4;
  }

  alert(a); // alerts '4', not the global value of '1'
};

function five() {
  this.a = 5;
}
// five();


		var settingsObj = createGameSettings();

		//creates scene, add fog
		var scene = new THREE.Scene();
		scene.fog = new THREE.FogExp2( 0x000000, 0.01);

		//creates two camers
		var gameCamera = new THREE.PerspectiveCamera(75, settingsObj.screenRatio(), 0.1, 1000);

		// freeCamera.position.set(2,2,2);

		var renderer = new THREE.WebGLRenderer();
		renderer.setSize(window.innerWidth, window.innerHeight);

		canvas = document.getElementById('canvas');
		canvas.appendChild(renderer.domElement);






		// settingsObj.setGameAreaWidth(12);
		// settingsObj.setGameAreaHeight(12);
		// settingsObj.setGameAreaDepth(-180);


		var timer = createTimer();

		// timer.initTest();
		// timer.updateTest();


		var stateCTRL = createGameState(
			function(){
				console.log("here come dat boi");
			},
			function(){
				console.log("hey waddupp?");
			}
		);

		// stateCTRL.testInit();

// for later
		var gameControl = createGameIOManager( );
		window.addEventListener("keydown",gameControl.keyDownAction);

		gameControl.addFunction(
			32 ,
			stateCTRL.start
		);

		gameControl.addFunction(
			67 ,
			function(){

			}
		);



		// console.log(gameControl.keyDownAction({ keyCode : 32 }));

		// console.log( gameControl );
		// gameControl.keyDownAction({keyCode: 37})





		var envi = createEnvironment(settingsObj , 12 , 12 , 150 ,timer, gameControl);

		// console.log(gameControl.keyDownAction({ keyCode : 39 }));
		// envi.testIO();
		// gameControl.unitTest();


		scene.add(envi.gameScene());

		envi.setPosition(
			0 ,
      0 ,
      -((settingsObj.gameAreaDepth() / 2) + 4)
		);
		// envi.initTest();



		envi.addAsteroids();
		// envi.spaceShitTest();


		function render() {
			renderer.render(scene, gameCamera);

		}


		function animate() {

			requestAnimationFrame(animate);
			// ast.move(timer.getTime());


			// console.log("/////////////////////");
			envi.moveAsteroids();
			envi.moveAsteroidTest();

			envi.animateEnvironment();

			timer.update();
			// console.log(settingsObj.asteroidStartPoint() );




			render();
		}
		// console.log( settingsObj.spawnDelay());
		animate();
		// test












		</script>
		<!-- <script src="lib/three.min.js"></script>
	  	<script src="lib/stats.min.js"></script>
	 	<script src="js/controls.js"></script>
		<script src="js/OrbitControls.js"></script>
		<script src="js/switchCamera.js"></script>
		<script src="js/clock.js"></script>
		<script src="js/gameSettings.js"></script>
		<script src="js/main.js"></script>
		<script src="js/interface.js"></script>
		<script src="js/game_loop.js"></script>
		<script src="js/environment.js"></script>
		<script src="js/asteroid.js"></script>
		<script src="js/spaceship.js"></script>
		<script src="js/collisionDetection.js"></script>
		<script src="js/rendering.js"></script>
		 -->


	</body>
</html>
